<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width,initial-scale=1" />
        <title>PyScript - Python on website</title>
        <script src="./mini-coi-fd.js"></script>
        <script type="module" src="./pyscript/core.js" offline></script>
        <link rel="stylesheet" href="./pyscript/core.css">
    </head>
    <body>
        <a href="/index.html"> Back to homepage </a>
        <p>==========================================</p>
        <script type="py" terminal worker>
            import time, traceback, platform, sys, pyodide
            
            async def cookie_finder():
                yes = await input("Do you wanna install pip packages (Y/n)? ").lower() == 'y'
                if yes:
                    packs = await input("Enter package name (if multiple, split by space): ").split()
                else: 
                    packs = []
                return packs
            
            async def terminal():
                await pyodide.loadPackagesFromImports("micropip")
                import micropip
                cook = cookie_finder()
                if cook: 
                    pip = ", ".join(cook) if len(cook) > 1 else cook[0]
                    print(f"Package(s) installing: {pip}")
                    for cooks in cook:
                        print(f"Installing package {cooks}", end="\r")
                        await micropip.install(cooks)
                names = {**globals(), **locals()} 
                print("Opening terminal ...", end="\r")
                time.sleep(2.825)
                print(f"Python {sys.version} \n(Erkhemee Edition)")
                enter = ">>>"
                alls = []
                while 1:
                   try:
                      execute= await input(f"{enter} ")
                      if not ":" in execute and enter == ">>>": 
                         enter = ">>>"
                         exec(execute, names)
                      elif enter == "..." and not bool(execute):
                         exec("\n".join(alls), names)
                         alls=[]
                         enter = ">>>"
                      elif enter == "..." or execute.strip().endswith(":"):
                         enter = "..."
                         alls.append(execute)
                      else: 
                         enter = ">>>"
                   except SystemExit as code:
                      break
                   except Exception as e:
                     print("".join(traceback.format_exception(e)))
                     alls=[]
                     enter = ">>>"
                print(f"Exited terminal. {code}")
                print("Bye! ")

            print(dir(pyodide))
            print("Hello from Python (Pyodide)", platform.python_version())
            print("Program doesn't store your data, so don't worry!")
            print("Hint: Try entering @:/\\:@")
            name = await input("What is your name? ")
            if name != "@:/\\:@": 
                favs = ["Minecraft movie", "Chicken", "Strawberry", "Potato", "Geometry dash and Minecraft"]
                favr = ["Movie", "Food", "Fruit", "Vegetable", "Game"]
                for fav in favr: 
                     user = await input(f"{name}'s (Your) Favourite {fav}: ")
                print("My name is Erkhembayr")
                for a in [0, 1, 2, 3, 4]: 
                    print(f"Erkhembayr's (My) Favourite {favr[a]}: {favs[a]}")
                selector = await input("Do you want to open python terminal (yes/no): ")
                selector = selector.lower()
                if selector == "yes":
                    await terminal()
                else:
                    print("Bye! ")
                    time.sleep(5)
            else: 
                print("Secret: UNLOCKED! You entered @:/\\:@")
                await terminal()
        </script>
    </body>
</html>
